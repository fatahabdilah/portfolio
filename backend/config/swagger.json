{
  "openapi": "3.0.0",
  "info": {
    "title": "My Portfolio API",
    "version": "1.0.0",
    "description": "The official REST API for Fatah Abdilah's portfolio application. This API manages projects, skills, and user authentication.",
    "contact": {
      "name": "Fatah Abdilah",
      "email": "fatah.abdilah@example.com",
      "url": "https://fatahabdilah.site"
    },
    "license": {
      "name": "ISC",
      "url": "https://opensource.org/licenses/ISC"
    }
  },
  "servers": [
    {
      "url": "http://localhost:5000"
    }
  ],
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "Project": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string",
            "example": "60d0fe4f5311236168a109ca"
          },
          "title": {
            "type": "string",
            "example": "E-commerce Platform"
          },
          "description": {
            "type": "string",
            "example": "A full-featured e-commerce website built with the MERN stack."
          },
          "technologies": {
            "type": "array",
            "description": "An array of Skill objects associated with the project.",
            "items": {
              "$ref": "#/components/schemas/Skill"
            },
            "example": [
              {
                "_id": "60d0fe4f5311236168a109cb",
                "name": "React"
              },
              {
                "_id": "60d0fe4f5311236168a109cc",
                "name": "Node.js"
              }
            ]
          },
          "projectImage": {
            "type": "string",
            "format": "uri",
            "example": "https://res.cloudinary.com/demo/image/upload/v1624582000/sample.jpg"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Skill": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string",
            "example": "60d0fe4f5311236168a109cb"
          },
          "name": {
            "type": "string",
            "example": "JavaScript"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Error": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string"
          }
        },
        "required": ["error"],
        "examples": [
          {
            "error": "Resource not found."
          }
        ]
      },
      "SuccessMessage": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string"
          }
        },
        "required": ["message"]
      },
      "UserLoginSuccess": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "example": "admin@myportfolio.com"
          },
          "name": {
            "type": "string",
            "example": "Fatah Abdilah"
          },
          "token": {
            "type": "string",
            "description": "The JWT token used for subsequent private API calls."
          }
        },
        "required": ["email", "name", "token"]
      }
    },
    "responses": {
      "UnauthorizedError": {
        "description": "Authentication error. The provided JWT is either missing, invalid, or expired.",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": { "error": "Request is not authorized" }
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Projects",
      "description": "Everything about your Projects"
    },
    {
      "name": "Skills",
      "description": "Everything about your Skills"
    },
    {
      "name": "Users",
      "description": "User authentication and management"
    }
  ],
  "paths": {
    "/api/projects": {
      "get": {
        "tags": ["Projects"],
        "summary": "Fetch all projects",
        "description": "Retrieves a list of all project entries from the database. This endpoint is public and does not require authentication.",
        "security": [],
        "responses": {
          "200": {
            "description": "A list of all projects was successfully retrieved.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Project" }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Projects"],
        "summary": "Create a new project",
        "description": "Adds a new project to the database. Requires authentication. The request must be `multipart/form-data` to handle the image upload.",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "technologies": {
                    "type": "string",
                    "description": "Comma-separated list of Skill Object IDs."
                  },
                  "projectImage": {
                    "type": "string",
                    "format": "binary"
                  }
                },
                "required": ["title", "description", "technologies", "projectImage"]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "The project was created successfully.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Project" }
              }
            }
          },
          "400": {
            "description": "Bad Request. Input validation failed or there was an issue with the image upload.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "description": "Internal Server Error.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      }
    },
    "/api/projects/{id}": {
      "get": {
        "tags": ["Projects"],
        "summary": "Fetch a single project by its ID",
        "description": "Retrieves a specific project using its unique MongoDB ObjectID. This endpoint is public.",
        "security": [],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The MongoDB ObjectID of the project to retrieve."
          }
        ],
        "responses": {
          "200": {
            "description": "The requested project was found and returned.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Project" }
              }
            }
          },
          "404": {
            "description": "Not Found. A project with the specified ID does not exist.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Projects"],
        "summary": "Delete a project",
        "description": "Permanently removes a project from the database and deletes its associated image from Cloudinary. Requires authentication.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The MongoDB ObjectID of the project to delete."
          }
        ],
        "responses": {
          "200": {
            "description": "The project was deleted successfully.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/SuccessMessage" }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "description": "Not Found. A project with the specified ID does not exist or the user is not authorized to delete it.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      },
      "patch": {
        "tags": ["Projects"],
        "summary": "Update an existing project",
        "description": "Updates one or more fields of an existing project. Requires authentication. The request must be `multipart/form-data` if an image is being updated.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The MongoDB ObjectID of the project to update."
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "technologies": {
                    "type": "string",
                    "description": "Comma-separated list of Skill Object IDs."
                  },
                  "projectImage": {
                    "type": "string",
                    "format": "binary",
                    "description": "Optional new image file to replace the old one."
                  },
                  "demoUrl": {
                    "type": "string"
                  },
                  "repoUrl": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The project was updated successfully.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Project" }
              }
            }
          },
          "400": {
            "description": "Bad Request. Input validation failed.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "description": "Not Found. A project with the specified ID does not exist or the user is not authorized to update it.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      }
    },
    "/api/skills": {
      "get": {
        "tags": ["Skills"],
        "summary": "Fetch all available skills (Private)",
        "description": "Retrieves a list of all skills from the database, sorted alphabetically. Requires authentication.",
        "responses": {
          "200": {
            "description": "A list of all skills was successfully retrieved.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Skill" }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "description": "Internal Server Error.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Skills"],
        "summary": "Create a new skill entry",
        "description": "Adds a new skill to the database. Requires authentication.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  }
                },
                "required": ["name"],
                "example": { "name": "Docker" }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "The skill was created successfully.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Skill" }
              }
            }
          },
          "400": {
            "description": "Bad Request. The skill may already exist or the name is invalid.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          }
        }
      }
    },
    "/api/skills/{id}": {
      "get": {
        "tags": ["Skills"],
        "summary": "Fetch a single skill by ID (Private)",
        "description": "Retrieves a specific skill using its unique MongoDB ObjectID. Requires authentication.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The MongoDB ObjectID of the skill to retrieve."
          }
        ],
        "responses": {
          "200": {
            "description": "The requested skill was found and returned.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Skill" }
              }
            }
          },
          "404": {
            "description": "Not Found. A skill with the specified ID does not exist.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      },
      "patch": {
        "tags": ["Skills"],
        "summary": "Update a skill's name",
        "description": "Updates the name of an existing skill. Requires authentication.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The MongoDB ObjectID of the skill to update."
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  }
                },
                "required": ["name"],
                "example": { "name": "Kubernetes" }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The skill was updated successfully.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Skill" }
              }
            }
          },
          "400": {
            "description": "Bad Request. The skill name may already exist or is invalid.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "description": "Not Found. A skill with the specified ID does not exist or the user is not authorized to update it.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Skills"],
        "summary": "Delete a skill",
        "description": "Permanently removes a skill from the database. Deletion automatically removes references from all related projects (cascade delete). Requires authentication.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The MongoDB ObjectID of the skill to delete."
          }
        ],
        "responses": {
          "200": {
            "description": "The skill was deleted successfully.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/SuccessMessage" }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "description": "Not Found. A skill with the specified ID does not exist or the user is not authorized to delete it.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      }
    },
    "/api/users/forgot-password": {
      "post": {
        "tags": ["Users"],
        "summary": "Initiate the password reset flow",
        "description": "Sends a password reset link to the user's email address if the account exists. For security reasons, this endpoint always returns a success message, regardless of whether the email was found in the database. The reset link token is **valid for 1 hour**.",
        "security": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email"
                  }
                },
                "required": ["email"],
                "example": { "email": "user@example.com" }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The request has been processed. If an account with this email exists, a reset link has been sent.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/SuccessMessage" }
              }
            }
          },
          "500": {
            "description": "Internal Server Error, e.g., failed to send the email.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      }
    },
    "/api/users/login": {
      "post": {
        "tags": ["Users"],
        "summary": "Authenticate user and get a token",
        "description": "Authenticates a user's credentials (email and password) and returns a JWT token for accessing protected endpoints.",
        "security": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email",
                    "example": "admin@myportfolio.com"
                  },
                  "password": {
                    "type": "string",
                    "format": "password",
                    "example": "ChangeMe123!"
                  }
                },
                "required": ["email", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Login successful. Returns user details and the JWT token.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/UserLoginSuccess" }
              }
            }
          },
          "400": {
            "description": "Bad Request. Incorrect email or password.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      }
    },
    "/api/users/resetpassword/{token}": {
      "patch": {
        "tags": ["Users"],
        "summary": "Finalizes the password reset",
        "description": "Resets user's password using the token provided in the URL. The token is consumed immediately upon successful reset and automatically expires after 1 hour if unused.",
        "security": [],
        "parameters": [
          {
            "name": "token",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The password reset token from the email link."
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "password": {
                    "type": "string",
                    "format": "password",
                    "example": "MyNewSecurePassword123!"
                  }
                },
                "required": ["password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The password was reset successfully.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/SuccessMessage" }
              }
            }
          },
          "400": {
            "description": "Bad Request. The password reset token is invalid or has expired.",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Error" }
              }
            }
          }
        }
      }
    },
    "/api/users/profile": {
      "get": {
        "tags": ["Users"],
        "summary": "Get authenticated user's profile",
        "description": "Fetches the profile data for the currently authenticated user. Requires a valid JWT in the Authorization header.",
        "responses": {
          "200": {
            "description": "User profile data retrieved successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": { "type": "string" },
                    "userId": { "type": "string" }
                  }
                }
              }
            }
          },
          "401": { "$ref": "#/components/responses/UnauthorizedError" }
        }
      }
    }
  }
}